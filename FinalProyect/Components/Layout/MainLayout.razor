@inherits LayoutComponentBase

<div class="page-wrapper">

    <aside class="sidebar-wrapper">
        <NavMenu />
    </aside>

    <main class="main-content d-flex flex-column">

        <Topbar />

        <div class="container-fluid py-4 flex-grow-1">
            @Body
        </div>

        <Footer />

    </main>
</div>

<script src="scripts/print.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
    window.historialExport = {

        exportPDF: function () {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.text("Historial de Ingresos", 14, 10);

            const table = document.querySelector("table");

            // Check if table exists to avoid errors
            if (table) {
                doc.autoTable({
                    html: table,
                    theme: 'grid',
                    startY: 20,
                });
                doc.save("Historial_Ingresos.pdf");
            } else {
                alert("No table found to export!");
            }
        },

        exportExcel: function () {
            const table = document.querySelector("table");
            if (table) {
                const wb = XLSX.utils.table_to_book(table);
                XLSX.writeFile(wb, "Historial_Ingresos.xlsx");
            } else {
                alert("No table found to export!");
            }
        }
    };
</script>